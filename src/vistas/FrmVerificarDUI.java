package vistas;

import controlador.CtrlResponsable;
import java.awt.Component;
import javax.swing.JOptionPane;
import javax.swing.plaf.basic.BasicInternalFrameUI;
import modelo.MtoResponsable;
import modelo.Validaciones;

/**
 *
 * @author EDUARDO
 */
public class FrmVerificarDUI extends javax.swing.JInternalFrame {

    //Llamando clases
    CtrlResponsable responsableCtrl = new CtrlResponsable();
    MtoResponsable responsable = new MtoResponsable();
    Validaciones val = new Validaciones();
    
    public FrmVerificarDUI() {
        initComponents();
        this.setBorder(null);
        BasicInternalFrameUI bui = (BasicInternalFrameUI) this.getUI();
        bui.setNorthPane(null);
        for (Component component : pnlResponsable.getComponents()) {
        component.setEnabled(false); 
        }
        
        //Llenando combobox
        this.llenarParentesco();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        pnlResponsable = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        btnAgregar = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jLayeredPane1 = new javax.swing.JLayeredPane();
        jNombre = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jApellido = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        jTel = new javax.swing.JFormattedTextField();
        jLayeredPane2 = new javax.swing.JLayeredPane();
        cbParentesco = new javax.swing.JComboBox<>();
        jLabel1 = new javax.swing.JLabel();
        jCorreo = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        pnlVerificar = new javax.swing.JPanel();
        jLabel2 = new javax.swing.JLabel();
        btnVerificar = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();
        jButton2 = new javax.swing.JButton();
        jDui = new javax.swing.JFormattedTextField();
        jSeparator1 = new javax.swing.JSeparator();

        setPreferredSize(new java.awt.Dimension(1080, 650));
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel1.setBackground(new java.awt.Color(33, 37, 41));
        jPanel1.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        pnlResponsable.setBackground(new java.awt.Color(33, 37, 41));
        pnlResponsable.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel7.setFont(new java.awt.Font("Roboto", 0, 16)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(255, 255, 255));
        jLabel7.setText("Registro del responsable:");
        pnlResponsable.add(jLabel7, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 10, 210, 30));

        btnAgregar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/btnAgregar_default.png"))); // NOI18N
        btnAgregar.setBorder(null);
        btnAgregar.setBorderPainted(false);
        btnAgregar.setContentAreaFilled(false);
        btnAgregar.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnAgregar.setRolloverIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/btnAgregar_rollover.png"))); // NOI18N
        btnAgregar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAgregarActionPerformed(evt);
            }
        });
        pnlResponsable.add(btnAgregar, new org.netbeans.lib.awtextra.AbsoluteConstraints(470, 230, 160, 80));

        jButton4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/btnReingresarDUIDefault.png"))); // NOI18N
        jButton4.setBorder(null);
        jButton4.setBorderPainted(false);
        jButton4.setContentAreaFilled(false);
        jButton4.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        jButton4.setRolloverIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/btnReingresarDUIRollover.png"))); // NOI18N
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        pnlResponsable.add(jButton4, new org.netbeans.lib.awtextra.AbsoluteConstraints(770, 100, 180, 90));

        jLayeredPane1.setNextFocusableComponent(jLayeredPane2);
        jLayeredPane1.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jNombre.setBackground(new java.awt.Color(33, 37, 41));
        jNombre.setFont(new java.awt.Font("Roboto Black", 0, 16)); // NOI18N
        jNombre.setForeground(new java.awt.Color(255, 255, 255));
        jNombre.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jNombre.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(119, 119, 119)));
        jNombre.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jNombreKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                jNombreKeyTyped(evt);
            }
        });
        jLayeredPane1.add(jNombre, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 30, 230, 30));

        jLabel8.setFont(new java.awt.Font("Roboto", 0, 16)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(255, 255, 255));
        jLabel8.setText("Nombre:");
        jLayeredPane1.add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 0, 80, 30));

        jLabel4.setFont(new java.awt.Font("Roboto", 0, 16)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(255, 255, 255));
        jLabel4.setText("Apellido:");
        jLayeredPane1.add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 70, 80, 30));

        jApellido.setBackground(new java.awt.Color(33, 37, 41));
        jApellido.setFont(new java.awt.Font("Roboto Black", 0, 16)); // NOI18N
        jApellido.setForeground(new java.awt.Color(255, 255, 255));
        jApellido.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jApellido.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(119, 119, 119)));
        jApellido.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jApellidoKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                jApellidoKeyTyped(evt);
            }
        });
        jLayeredPane1.add(jApellido, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 100, 230, 30));

        jLabel5.setFont(new java.awt.Font("Roboto", 0, 16)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(255, 255, 255));
        jLabel5.setText("Teléfono:");
        jLayeredPane1.add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 140, 80, 30));

        jTel.setBackground(new java.awt.Color(33, 37, 41));
        jTel.setForeground(new java.awt.Color(255, 255, 255));
        try {
            jTel.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("####-####")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        jTel.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jTel.setFont(new java.awt.Font("Roboto Black", 0, 16)); // NOI18N
        jLayeredPane1.add(jTel, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 170, 230, 30));

        pnlResponsable.add(jLayeredPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(120, 60, 270, 230));

        jLayeredPane2.setNextFocusableComponent(jLayeredPane1);
        jLayeredPane2.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        cbParentesco.setBackground(new java.awt.Color(33, 37, 41));
        cbParentesco.setFont(new java.awt.Font("Roboto Black", 0, 16)); // NOI18N
        cbParentesco.setForeground(new java.awt.Color(255, 255, 255));
        cbParentesco.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        cbParentesco.setBorder(null);
        jLayeredPane2.add(cbParentesco, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 110, 230, -1));

        jLabel1.setFont(new java.awt.Font("Roboto", 0, 16)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setText("Parentesco:");
        jLayeredPane2.add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 80, 110, 30));

        jCorreo.setBackground(new java.awt.Color(33, 37, 41));
        jCorreo.setFont(new java.awt.Font("Roboto Black", 0, 16)); // NOI18N
        jCorreo.setForeground(new java.awt.Color(255, 255, 255));
        jCorreo.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jCorreo.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(119, 119, 119)));
        jCorreo.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jCorreoKeyPressed(evt);
            }
        });
        jLayeredPane2.add(jCorreo, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 40, 230, 30));

        jLabel6.setFont(new java.awt.Font("Roboto", 0, 16)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(255, 255, 255));
        jLabel6.setText("Correo Electrónico:");
        jLayeredPane2.add(jLabel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, 160, 30));

        pnlResponsable.add(jLayeredPane2, new org.netbeans.lib.awtextra.AbsoluteConstraints(430, 50, 250, 280));

        jPanel1.add(pnlResponsable, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 250, 1060, 350));

        pnlVerificar.setBackground(new java.awt.Color(33, 37, 41));
        pnlVerificar.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel2.setFont(new java.awt.Font("Roboto", 0, 16)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(255, 255, 255));
        jLabel2.setText("<html><p style=overflow:auto;>Para continuar, ingrese el DUI del responsable para verificar si este existe o no, si el DUI ingresado no existe, podra ingresar los datos del nuevo responsable.</p>");
        pnlVerificar.add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 40, 970, -1));

        btnVerificar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/btnVerificar_rollover-1.png"))); // NOI18N
        btnVerificar.setBorder(null);
        btnVerificar.setBorderPainted(false);
        btnVerificar.setContentAreaFilled(false);
        btnVerificar.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnVerificar.setRolloverIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/btnVerificar_default.png"))); // NOI18N
        btnVerificar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnVerificarActionPerformed(evt);
            }
        });
        pnlVerificar.add(btnVerificar, new org.netbeans.lib.awtextra.AbsoluteConstraints(580, 110, 180, 70));

        jLabel3.setFont(new java.awt.Font("Roboto", 0, 16)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setText("DUI: ");
        pnlVerificar.add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(350, 130, 40, 30));

        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/btnVerificar_rollover-1.png"))); // NOI18N
        jButton2.setBorder(null);
        jButton2.setBorderPainted(false);
        jButton2.setContentAreaFilled(false);
        jButton2.setRolloverIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/btnVerificar_default.png"))); // NOI18N
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        pnlVerificar.add(jButton2, new org.netbeans.lib.awtextra.AbsoluteConstraints(580, 110, 180, 70));

        jDui.setBackground(new java.awt.Color(33, 37, 41));
        jDui.setForeground(new java.awt.Color(255, 255, 255));
        try {
            jDui.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.MaskFormatter("########-#")));
        } catch (java.text.ParseException ex) {
            ex.printStackTrace();
        }
        jDui.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jDui.setFont(new java.awt.Font("Roboto Black", 0, 16)); // NOI18N
        pnlVerificar.add(jDui, new org.netbeans.lib.awtextra.AbsoluteConstraints(390, 130, 180, 30));

        jPanel1.add(pnlVerificar, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, 1060, 220));

        jSeparator1.setBackground(new java.awt.Color(33, 37, 41));
        jSeparator1.setForeground(new java.awt.Color(119, 119, 119));
        jPanel1.add(jSeparator1, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 230, 1010, 20));

        getContentPane().add(jPanel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 1080, 760));

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton2ActionPerformed

    private void btnVerificarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnVerificarActionPerformed
        responsableCtrl.setForm(0);
        //Validando campos vacios
        if (jDui.getText().trim().isEmpty()) {
            JOptionPane.showMessageDialog(null, "Campos vacios.","Rellene los campos faltantes.",JOptionPane.WARNING_MESSAGE);
        } else {
            
            //Enviando valor a la clase
            responsableCtrl.setDui(jDui.getText());
            
            //Verificando existencia
            if (responsable.verificarDui()) {
                JOptionPane.showMessageDialog(null, "Se ha encontrado un registro con este DUI. Seleccionar siguiente para seguir el proceso");
                responsableCtrl.setForm(1);
            } else {
                JOptionPane.showMessageDialog(null, "No se ha encontrado un registro con este DUI. Ingresar el nuevo responsable");
                for (Component component : pnlVerificar.getComponents()) {
                component.setEnabled(false);  
                }

                for (Component component : pnlResponsable.getComponents()) {
                    component.setEnabled(true);  
                }
            }
        }
        
    }//GEN-LAST:event_btnVerificarActionPerformed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        for (Component component : pnlVerificar.getComponents()) {
            component.setEnabled(true);  
        }
        
        for (Component component : pnlResponsable.getComponents()) {
            component.setEnabled(false);  
        }
        
        this.limpiarCampos();
    }//GEN-LAST:event_jButton4ActionPerformed

    private void btnAgregarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAgregarActionPerformed
       
        //Validando campos vacios
        if ((jNombre.getText().trim().isEmpty()) || (jApellido.getText().trim().isEmpty()) 
                || (jTel.getText().trim().isEmpty()) || (jCorreo.getText().trim().isEmpty())) {
            JOptionPane.showMessageDialog(null, "Campos vacios.","Rellene los campos faltantes.",JOptionPane.WARNING_MESSAGE);
        }
        else if(val.email(jCorreo.getText())) 
        {
            //Enviando datos a la tabla
            responsableCtrl.setNombre(jNombre.getText());
            responsableCtrl.setApellido(jApellido.getText());
            responsableCtrl.setTelefono(jTel.getText());
            responsableCtrl.setEmail(jCorreo.getText());
            responsableCtrl.setIdEstado(1);
            responsable.obtenerIdParentesco(cbParentesco.getItemAt(cbParentesco.getSelectedIndex()));
            responsable.obtenerUltimoId();
            
            //Agregando datos
            if (responsable.insertarResponsable()) {
                JOptionPane.showMessageDialog(null, "Se ha agregado el responsable correctamente. Seleccionar siguiente para seguir el proceso");
                btnAgregar.setEnabled(false);
                this.limpiarCampos();
                responsableCtrl.setForm(1);
            } else {
                JOptionPane.showMessageDialog(null, "No se ha agregado el responsable correctamente. Seleccionar siguiente para seguir el proceso");
            }
        }
        else
        {
            JOptionPane.showMessageDialog(null, "Correo invalido.","Advertencia",JOptionPane.WARNING_MESSAGE);
        }
    }//GEN-LAST:event_btnAgregarActionPerformed

    private void jNombreKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jNombreKeyPressed
        // TODO add your handling code here:
        String Caracteres = jNombre.getText();
        if(Caracteres.length()>=30){
            jNombre.setText("");
            JOptionPane.showMessageDialog(null, "Limite de carácteres alcanzado.","Aviso",JOptionPane.WARNING_MESSAGE);
        }
        
        val.verificarPegar(evt);
    }//GEN-LAST:event_jNombreKeyPressed

    private void jNombreKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jNombreKeyTyped
        val.verificarLetras(evt);
    }//GEN-LAST:event_jNombreKeyTyped

    private void jApellidoKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jApellidoKeyPressed
        String Caracteres = jApellido.getText();
        if(Caracteres.length()>=30){
            jApellido.setText("");
            JOptionPane.showMessageDialog(null, "Limite de carácteres alcanzado.","Aviso",JOptionPane.WARNING_MESSAGE);
        }
        val.verificarPegar(evt);
    }//GEN-LAST:event_jApellidoKeyPressed

    private void jApellidoKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jApellidoKeyTyped
        val.verificarLetras(evt);
    }//GEN-LAST:event_jApellidoKeyTyped

    private void jCorreoKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jCorreoKeyPressed
        String Caracteres = jCorreo.getText();
        if(Caracteres.length()>=50){
            jCorreo.setText("");
            JOptionPane.showMessageDialog(null, "Limite de carácteres alcanzado.","Aviso",JOptionPane.WARNING_MESSAGE);
        }
        
        val.verificarPegar(evt);
    }//GEN-LAST:event_jCorreoKeyPressed
       
    public void limpiarCampos(){
        jNombre.setText("");
        jApellido.setText("");
        jTel.setText("");
        jCorreo.setText("");
    }
    
    public void llenarParentesco(){
        
        //Llenando combobox
        cbParentesco.setModel(responsable.llenarParentesco());
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAgregar;
    private javax.swing.JButton btnVerificar;
    private javax.swing.JComboBox<String> cbParentesco;
    private javax.swing.JTextField jApellido;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton4;
    private javax.swing.JTextField jCorreo;
    private javax.swing.JFormattedTextField jDui;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLayeredPane jLayeredPane1;
    private javax.swing.JLayeredPane jLayeredPane2;
    private javax.swing.JTextField jNombre;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JFormattedTextField jTel;
    private javax.swing.JPanel pnlResponsable;
    private javax.swing.JPanel pnlVerificar;
    // End of variables declaration//GEN-END:variables
}
